import{_ as n,o as s,c as a,b as t}from"./app-571c1f36.js";const p={},e=t(`<h1 id="vxetable-复刻区域选择、拖动柄" tabindex="-1"><a class="header-anchor" href="#vxetable-复刻区域选择、拖动柄" aria-hidden="true">#</a> vxeTable 复刻区域选择、拖动柄</h1><h3 id="介绍" tabindex="-1"><a class="header-anchor" href="#介绍" aria-hidden="true">#</a> 介绍</h3><pre><code>vxetable是一个基于 Vue（支持 Vue3） 的 PC 端全功能表格组件，满足你对 table 绝大多数需求，可与任意组件库完美兼容。VXE Table面向现代浏览器，高效的简洁 API 设计，模块化表格、按需加载、扩展接口，为单行编辑表格而设计，支持增删改查及更多扩展，强大的功能的同时兼具性能。

Vxe-table 提供诸多功能：虚拟滚动、懒加载、快捷菜单、数据校验、树形结构、打印导出、表单渲染、数据分页、虚拟列表、模态窗口、自定义模板、渲染器，每一个功能做细了都不容易。

需要的直接点击传送门：https://vxetable.cn/
</code></pre><h3 id="缘起" tabindex="-1"><a class="header-anchor" href="#缘起" aria-hidden="true">#</a> 缘起</h3><pre><code>我们的系统的表格，需要支持像excel那样区域选择，进行复制粘贴，拖拽区域的右下方需要有一个拖动柄可以进行复制。使用的vxe-table是有这个功能的，但是这个功能需要收费，所以就自己参考着写（CV）了一个。
</code></pre><h3 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h3><pre><code>1. https://blog.csdn.net/wanghanlu_/article/details/132376047?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170591700916800222863864%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=170591700916800222863864&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-132376047-null-null.142^v99^pc_search_result_base9&amp;utm_term=vxetable%E5%8C%BA%E5%9F%9F%E9%80%89%E6%8B%A9&amp;spm=1018.2226.3001.4187
2. https://blog.csdn.net/weixin_45366616/article/details/133739353?spm=1001.2014.3001.5501
</code></pre><h3 id="实现" tabindex="-1"><a class="header-anchor" href="#实现" aria-hidden="true">#</a> 实现</h3><pre><code>实现拖动区域选择，如果是vue2版本可以使用参考1。如果是vue3版本的可以使用参考2。使用了上述的代码，你的vxe-table表格就可以实现区域选择。

我是vue3版本的，所以使用的是参考2。复制下来改吧改吧就能区域选择，但是需要加上按键复制粘贴和拖动柄的功能。接下来就直接上代码。
</code></pre><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 正常区域的框 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-area&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;cellarea&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 选择显示的框 <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-main-area&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 拖动柄的类名 <span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-main-area-btn&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-active-area&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-extend-area&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 左侧fixed区域的框 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-area&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;leftfixedcellarea&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-main-area&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-main-area-btn&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-active-area&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-extend-area&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 右侧fixed区域的框 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-area&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;rightfixedcellarea&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-main-area&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-main-area-btn&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-active-area&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;vxe-table--cell-extend-area&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;apptable table-padding-7&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>vxe<span class="token operator">-</span>grid
            v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;tableConfig&quot;</span>
            ref<span class="token operator">=</span><span class="token string">&quot;tableCom&quot;</span>
            @edit<span class="token operator">-</span>closed<span class="token operator">=</span><span class="token string">&quot;editCollectClosedEvent&quot;</span>
            @current<span class="token operator">-</span>change<span class="token operator">=</span><span class="token string">&quot;currentCollectChangeEvent&quot;</span>
            @checkbox<span class="token operator">-</span>change<span class="token operator">=</span><span class="token string">&quot;selectCollectChangeEvent&quot;</span>
            @checkbox<span class="token operator">-</span>all<span class="token operator">=</span><span class="token string">&quot;selectCollectChangeEvent&quot;</span>
        <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>vxe<span class="token operator">-</span>grid<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">//#region 以下是鼠标选中功能</span>

<span class="token comment">//鼠标滑动选中</span>
<span class="token keyword">let</span> isSelecting <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 是否正在进行选择操作,默认为false</span>
<span class="token keyword">let</span> selectionStart <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> rowIndex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> cellIndex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 选择操作起始单元格位置</span>
<span class="token keyword">let</span> selectionEnd <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> rowIndex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> cellIndex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 选择操作结束单元格位置</span>

<span class="token comment">//获取页面ref节点</span>
<span class="token comment">//获取vxetable表格节点</span>
<span class="token comment">// let xGrid = ref();</span>
<span class="token keyword">let</span> cellarea <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> leftfixedcellarea <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> rightfixedcellarea <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//返回table的ref名称</span>
<span class="token keyword">const</span> <span class="token function-variable function">getTablexGrid</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> tableCom<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">tableCopy</span> <span class="token operator">=</span> event <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>ctrlKey <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span>key <span class="token operator">===</span> <span class="token string">&#39;c&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Ctrl + C event triggered!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionEnd<span class="token punctuation">.</span>rowIndex <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">copyEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>ctrlKey <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span>key <span class="token operator">===</span> <span class="token string">&#39;v&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;paste&#39;</span><span class="token punctuation">,</span> event <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionEnd<span class="token punctuation">.</span>rowIndex <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> paste <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>clipboardData <span class="token operator">||</span> window<span class="token punctuation">.</span>clipboardData<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isEditView<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">pasteEvent</span><span class="token punctuation">(</span>paste<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//添加事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">addListener</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//添加多选列</span>
  <span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// window.addEventListener(&#39;mousedown&#39;, tableOutDestroyAreaBox); //给window添加鼠标按下事件,判断是否在表格外,是销毁</span>
      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mouseup&#39;</span><span class="token punctuation">,</span> tbodymouseup<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给window添加鼠标松开事件</span>
      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;keydown&#39;</span><span class="token punctuation">,</span> tableCopy<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给window添加键盘按下事件</span>
      <span class="token keyword">let</span> tbody <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--main-wrapper table tbody&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取tbody区域</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>tbody<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        tbody<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousedown&#39;</span><span class="token punctuation">,</span> tbodymousedown<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的tbody添加鼠标按下事件</span>
        tbody<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousemove&#39;</span><span class="token punctuation">,</span> tbodymousemove<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的tbody添加鼠标移动事件</span>
        tbody<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mouseout&#39;</span><span class="token punctuation">,</span> <span class="token function">throttle</span><span class="token punctuation">(</span>tbodymouseout<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的tbody添加鼠标移出事件</span>
        tbody<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> tableCellClick<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//添加左键单击事件</span>
        <span class="token comment">// tbody.addEventListener(&#39;copy&#39;, (event) =&gt; {</span>
        <span class="token comment">//     copyEvent(event);</span>
        <span class="token comment">// });</span>
        tbody<span class="token punctuation">.</span>oncontextmenu <span class="token operator">=</span> tableCellMenuClick<span class="token punctuation">;</span> <span class="token comment">//添加右键菜单事件</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">let</span> bodyWrapper <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--main-wrapper .vxe-table--body-wrapper&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取正常区域的body</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>bodyWrapper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//注意这里的ref名称，这里是非fixed区域的框的名称</span>
        bodyWrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>cellarea<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//添加范围框元素</span>
      <span class="token punctuation">}</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//#region 左侧固定列</span>
        <span class="token keyword">let</span> leftfixedtbody <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-left-wrapper .vxe-table--body-wrapper table tbody&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取fixedtbody区域</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>leftfixedtbody<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          leftfixedtbody<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousedown&#39;</span><span class="token punctuation">,</span> tbodymousedown<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的leftfixedtbody添加鼠标按下事件</span>
          leftfixedtbody<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousemove&#39;</span><span class="token punctuation">,</span> tbodymousemove<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的leftfixedtbody添加鼠标移动事件</span>
          leftfixedtbody<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mouseout&#39;</span><span class="token punctuation">,</span> <span class="token function">throttle</span><span class="token punctuation">(</span>tbodymouseout<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的leftfixedtbody添加鼠标移出事件</span>
          leftfixedtbody<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> tableCellClick<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//添加单击事件</span>
          leftfixedtbody<span class="token punctuation">.</span>oncontextmenu <span class="token operator">=</span> tableCellMenuClick<span class="token punctuation">;</span> <span class="token comment">//添加右键菜单事件</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">let</span> leftFixedBodyWrapper <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-left-wrapper .vxe-table--body-wrapper&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>leftFixedBodyWrapper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">//注意这里的ref名称，这里是fixed区域的框的名称</span>
          leftFixedBodyWrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>leftfixedcellarea<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//#endregion</span>

        <span class="token comment">//#region 右侧固定列</span>
        <span class="token keyword">let</span> rightfixedtbody <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-right-wrapper .vxe-table--body-wrapper table tbody&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取fixedtbody区域</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>rightfixedtbody<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          rightfixedtbody<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousedown&#39;</span><span class="token punctuation">,</span> tbodymousedown<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的rightfixedtbody添加鼠标按下事件</span>
          rightfixedtbody<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousemove&#39;</span><span class="token punctuation">,</span> tbodymousemove<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的rightfixedtbody添加鼠标移动事件</span>
          rightfixedtbody<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mouseout&#39;</span><span class="token punctuation">,</span> <span class="token function">throttle</span><span class="token punctuation">(</span>tbodymouseout<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的rightfixedtbody添加鼠标移出事件</span>
          rightfixedtbody<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> tableCellClick<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//添加单击事件</span>
          rightfixedtbody<span class="token punctuation">.</span>oncontextmenu <span class="token operator">=</span> tableCellMenuClick<span class="token punctuation">;</span> <span class="token comment">//添加右键菜单事件</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">let</span> rightFixedBodyWrapper <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-right-wrapper .vxe-table--body-wrapper&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rightFixedBodyWrapper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">//注意这里的ref名称，这里是fixed区域的框的名称</span>
          rightFixedBodyWrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>rightfixedcellarea<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//#endregion</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 移除事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">removeListener</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//添加多选列</span>
  <span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// window.removeEventListener(&#39;mousedown&#39;, tableOutDestroyAreaBox); //给window添加鼠标按下事件,判断是否在表格外,是销毁</span>
      window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mouseup&#39;</span><span class="token punctuation">,</span> tbodymouseup<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给window添加鼠标松开事件</span>
      window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;keydown&#39;</span><span class="token punctuation">,</span> tableCopy<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给window添加键盘按下事件</span>
      window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;paste&#39;</span><span class="token punctuation">,</span> event <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionEnd<span class="token punctuation">.</span>rowIndex <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> paste <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>clipboardData <span class="token operator">||</span> window<span class="token punctuation">.</span>clipboardData<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>isEditView<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">pasteEvent</span><span class="token punctuation">(</span>paste<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> tbody <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--main-wrapper table tbody&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取tbody区域</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>tbody<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        tbody<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousedown&#39;</span><span class="token punctuation">,</span> tbodymousedown<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的tbody添加鼠标按下事件</span>
        tbody<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousemove&#39;</span><span class="token punctuation">,</span> tbodymousemove<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的tbody添加鼠标移动事件</span>
        tbody<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mouseout&#39;</span><span class="token punctuation">,</span> <span class="token function">throttle</span><span class="token punctuation">(</span>tbodymouseout<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的tbody添加鼠标移出事件</span>
        tbody<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> tableCellClick<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//添加左键单击事件</span>
        tbody<span class="token punctuation">.</span>oncontextmenu <span class="token operator">=</span> tableCellMenuClick<span class="token punctuation">;</span> <span class="token comment">//添加右键菜单事件</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">let</span> bodyWrapper <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--main-wrapper .vxe-table--body-wrapper&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取正常区域的body</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>bodyWrapper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//注意这里的ref名称，这里是非fixed区域的框的名称</span>
        bodyWrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>cellarea<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//添加范围框元素</span>
      <span class="token punctuation">}</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//#region 左侧固定列</span>
        <span class="token keyword">let</span> leftfixedtbody <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-left-wrapper .vxe-table--body-wrapper table tbody&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取fixedtbody区域</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>leftfixedtbody<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          leftfixedtbody<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousedown&#39;</span><span class="token punctuation">,</span> tbodymousedown<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的leftfixedtbody添加鼠标按下事件</span>
          leftfixedtbody<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousemove&#39;</span><span class="token punctuation">,</span> tbodymousemove<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的leftfixedtbody添加鼠标移动事件</span>
          leftfixedtbody<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mouseout&#39;</span><span class="token punctuation">,</span> <span class="token function">throttle</span><span class="token punctuation">(</span>tbodymouseout<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的leftfixedtbody添加鼠标移出事件</span>
          leftfixedtbody<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> tableCellClick<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//添加单击事件</span>
          leftfixedtbody<span class="token punctuation">.</span>oncontextmenu <span class="token operator">=</span> tableCellMenuClick<span class="token punctuation">;</span> <span class="token comment">//添加右键菜单事件</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">let</span> leftFixedBodyWrapper <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-left-wrapper .vxe-table--body-wrapper&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>leftFixedBodyWrapper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">//注意这里的ref名称，这里是fixed区域的框的名称</span>
          leftFixedBodyWrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>leftfixedcellarea<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//#endregion</span>

        <span class="token comment">//#region 右侧固定列</span>
        <span class="token keyword">let</span> rightfixedtbody <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-right-wrapper .vxe-table--body-wrapper table tbody&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取fixedtbody区域</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>rightfixedtbody<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          rightfixedtbody<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousedown&#39;</span><span class="token punctuation">,</span> tbodymousedown<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的rightfixedtbody添加鼠标按下事件</span>
          rightfixedtbody<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousemove&#39;</span><span class="token punctuation">,</span> tbodymousemove<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的rightfixedtbody添加鼠标移动事件</span>
          rightfixedtbody<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mouseout&#39;</span><span class="token punctuation">,</span> <span class="token function">throttle</span><span class="token punctuation">(</span>tbodymouseout<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的rightfixedtbody添加鼠标移出事件</span>
          rightfixedtbody<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> tableCellClick<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//添加单击事件</span>
          rightfixedtbody<span class="token punctuation">.</span>oncontextmenu <span class="token operator">=</span> tableCellMenuClick<span class="token punctuation">;</span> <span class="token comment">//添加右键菜单事件</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">let</span> rightFixedBodyWrapper <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-right-wrapper .vxe-table--body-wrapper&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rightFixedBodyWrapper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">//注意这里的ref名称，这里是fixed区域的框的名称</span>
          rightFixedBodyWrapper<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>rightfixedcellarea<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//#endregion</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 鼠标在填充柄按下事件</span>
<span class="token keyword">let</span> isExtendSelecting <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 是否正在进行选择操作,默认为false</span>
<span class="token keyword">let</span> selectionExtendOldStart <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> rowIndex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> cellIndex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 选择操作起始单元格位置</span>
<span class="token keyword">let</span> selectionExtendOldEnd <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> rowIndex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> cellIndex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 选择操作结束单元格位置</span>
<span class="token keyword">let</span> selectionExtendStart <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> rowIndex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> cellIndex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 选择操作起始单元格位置</span>
<span class="token keyword">let</span> selectionExtendEnd <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> rowIndex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> cellIndex<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 选择操作结束单元格位置</span>
<span class="token keyword">const</span> <span class="token function-variable function">extendmousedown</span> <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  event<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//阻止冒泡</span>
  <span class="token comment">//左键0,中键1,右键2</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>button <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//左键按下</span>
    <span class="token comment">// 记录当前选框的位置</span>
    selectionExtendOldStart <span class="token operator">=</span> <span class="token function">cloneDeep</span><span class="token punctuation">(</span>selectionStart<span class="token punctuation">)</span><span class="token punctuation">;</span>
    selectionExtendOldEnd <span class="token operator">=</span> <span class="token function">cloneDeep</span><span class="token punctuation">(</span>selectionEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    selectionExtendStart <span class="token operator">=</span> <span class="token function">cloneDeep</span><span class="token punctuation">(</span>selectionStart<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// selectionExtendOldEnd.rowIndex = selectionEnd.rowIndex;</span>
    <span class="token comment">// selectionExtendOldEnd.cellIndex = selectionEnd.cellIndex;</span>
    isExtendSelecting<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//标记为正在选择操作</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//鼠标按下事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">tbodymousedown</span> <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  event<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//阻止冒泡</span>
  <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closeMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//手动关闭右键菜单</span>
  <span class="token comment">//左键0,中键1,右键2</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>button <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//左键按下</span>
    <span class="token comment">// 记录选择操作起始位置</span>
    selectionStart <span class="token operator">=</span> <span class="token function">getCellPosition</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置选择操作起始单元格位置</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isExtendSelecting<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      isSelecting<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//标记为正在选择操作</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//鼠标移动事件</span>
<span class="token comment">//todo 这里要节流操作,只在结束时触发一次</span>
<span class="token keyword">const</span> <span class="token function-variable function">tbodymousemove</span> <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>button <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isExtendSelecting<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      selectionExtendEnd <span class="token operator">=</span> <span class="token function">getCellExtendPosition</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionExtendEnd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 设置样式 打开extend弹窗</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;设置样式 打开extend弹窗&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setselectedExtendCellArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">destroyExtendAreaBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//左键移动</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isSelecting<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//记录选择操作结束位置</span>
      selectionEnd <span class="token operator">=</span> <span class="token function">getCellPosition</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">//设置样式,并显示范围框</span>
      <span class="token function">setselectedCellArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isUp <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isLeft <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 填充柄填充数据方法，复制</span>
<span class="token keyword">const</span> <span class="token function-variable function">fillDatas</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>selectionExtendOldStart<span class="token punctuation">,</span> selectionExtendOldEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>selectionStart<span class="token punctuation">,</span> selectionEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> tableData <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTableData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>visibleData<span class="token punctuation">;</span>
  <span class="token keyword">let</span> tableColumn <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTableColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>visibleColumn<span class="token punctuation">;</span>
  <span class="token comment">// 复制的数据集</span>
  <span class="token keyword">let</span> copydata <span class="token operator">=</span> <span class="token function">getDataByArea</span><span class="token punctuation">(</span>selectionExtendOldStart<span class="token punctuation">,</span> selectionExtendOldEnd<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// copydata = copydata.reduce((a: string, b) =&gt; a + b.join(&#39;\\t&#39;) + &#39;\\n&#39;, &#39;&#39;).slice(0, -1);</span>
  <span class="token comment">// copydata = copydata.replace(/^\\r\\n+|\\r\\n+$/g, &#39;&#39;);</span>
  <span class="token comment">// let snsArr = copydata.split(/\\r\\n+/);</span>
  <span class="token comment">// let tArr = snsArr.map((value) =&gt; {</span>
  <span class="token comment">//     return value.split(&#39;\\t&#39;);</span>
  <span class="token comment">// });</span>
  <span class="token comment">// console.log(snsArr, tArr);</span>
  <span class="token keyword">const</span> lines <span class="token operator">=</span> copydata<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">const</span> cells <span class="token operator">=</span> copydata<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>lines<span class="token punctuation">,</span> cells<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 往纵向复制</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionExtendOldEnd<span class="token punctuation">.</span>cellIndex <span class="token operator">===</span> selectionEnd<span class="token punctuation">.</span>cellIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionExtendOldEnd<span class="token punctuation">.</span>rowIndex <span class="token operator">&lt;</span> selectionEnd<span class="token punctuation">.</span>rowIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 往下复制</span>
      <span class="token comment">// 最开始填充的行数</span>
      <span class="token keyword">const</span> needFillStartSelectionRowIndex <span class="token operator">=</span> selectionExtendOldEnd<span class="token punctuation">.</span>rowIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token comment">// 需要填充的总行数</span>
      <span class="token keyword">const</span> needFillLines <span class="token operator">=</span> selectionEnd<span class="token punctuation">.</span>rowIndex <span class="token operator">-</span> selectionExtendOldEnd<span class="token punctuation">.</span>rowIndex<span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> needFillLines<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 获取到被复制的某一行</span>
        <span class="token keyword">let</span> line <span class="token operator">=</span> copydata<span class="token punctuation">[</span>i <span class="token operator">%</span> lines<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">+</span> i <span class="token operator">&gt;</span> tableData<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> row <span class="token operator">=</span> tableData<span class="token punctuation">[</span>needFillStartSelectionRowIndex <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> line<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionStart<span class="token punctuation">.</span>cellIndex <span class="token operator">+</span> j <span class="token operator">&gt;</span> tableColumn<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> column <span class="token operator">=</span> tableColumn<span class="token punctuation">[</span>selectionStart<span class="token punctuation">.</span>cellIndex <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>column<span class="token punctuation">.</span>editRender<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            row<span class="token punctuation">[</span>column<span class="token punctuation">.</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> line<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionEnd<span class="token punctuation">.</span>rowIndex <span class="token operator">&lt;</span> selectionExtendOldEnd<span class="token punctuation">.</span>rowIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      isUp<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token comment">// 往上复制</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;往上复制&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 最开始填充的行数</span>
      <span class="token keyword">const</span> needFillStartSelectionRowIndex <span class="token operator">=</span> selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token comment">// 需要填充的总行数</span>
      <span class="token keyword">const</span> needFillLines <span class="token operator">=</span> selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">-</span> selectionEnd<span class="token punctuation">.</span>rowIndex<span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> needFillStartSelectionRowIndex<span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> selectionEnd<span class="token punctuation">.</span>rowIndex<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 获取到被复制的某一行</span>
        <span class="token keyword">let</span> line <span class="token operator">=</span> copydata<span class="token punctuation">[</span><span class="token punctuation">(</span>selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">-</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> lines<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> row <span class="token operator">=</span> tableData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> line<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionStart<span class="token punctuation">.</span>cellIndex <span class="token operator">+</span> j <span class="token operator">&gt;</span> tableColumn<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> column <span class="token operator">=</span> tableColumn<span class="token punctuation">[</span>selectionStart<span class="token punctuation">.</span>cellIndex <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>column<span class="token punctuation">.</span>editRender<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            row<span class="token punctuation">[</span>column<span class="token punctuation">.</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> line<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 横向复制</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionExtendOldEnd<span class="token punctuation">.</span>cellIndex <span class="token operator">&lt;</span> selectionEnd<span class="token punctuation">.</span>cellIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 往右复制</span>
      <span class="token comment">// 最开始填充的列数</span>
      <span class="token keyword">const</span> needFillStartSelectionCellIndex <span class="token operator">=</span> selectionExtendOldEnd<span class="token punctuation">.</span>cellIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token comment">// 需要填充的总列数</span>
      <span class="token keyword">const</span> needFillLines <span class="token operator">=</span> selectionEnd<span class="token punctuation">.</span>cellIndex <span class="token operator">-</span> selectionExtendOldEnd<span class="token punctuation">.</span>cellIndex<span class="token punctuation">;</span>
      <span class="token comment">// 需要填充的总行数</span>
      <span class="token comment">// const needFillLinesCount = selectionEnd.rowIndex - selectionStart.rowIndex;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lines<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 获取到被复制的某一行</span>
        <span class="token comment">// let line = copydata[i % needFillLinesCount];</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">+</span> i <span class="token operator">&gt;</span> tableData<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> row <span class="token operator">=</span> tableData<span class="token punctuation">[</span>selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> needFillLines<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>needFillStartSelectionCellIndex <span class="token operator">+</span> j <span class="token operator">&gt;</span> tableColumn<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> column <span class="token operator">=</span> tableColumn<span class="token punctuation">[</span>needFillStartSelectionCellIndex <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>column<span class="token punctuation">.</span>editRender<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            row<span class="token punctuation">[</span>column<span class="token punctuation">.</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> copydata<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">%</span> cells<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionEnd<span class="token punctuation">.</span>cellIndex <span class="token operator">&lt;</span> selectionExtendOldEnd<span class="token punctuation">.</span>cellIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      isLeft<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token comment">// 往左复制</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;往左复制&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 最开始填充的列数</span>
      <span class="token keyword">const</span> needFillStartSelectionCellIndex <span class="token operator">=</span> selectionExtendOldStart<span class="token punctuation">.</span>cellIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token comment">// 需要填充的总列数</span>
      <span class="token keyword">const</span> needFillLines <span class="token operator">=</span> selectionExtendOldStart<span class="token punctuation">.</span>cellIndex <span class="token operator">-</span> selectionEnd<span class="token punctuation">.</span>cellIndex<span class="token punctuation">;</span>
      <span class="token comment">// 需要填充的总行数</span>
      <span class="token comment">// const needFillLinesCount = selectionEnd.rowIndex - selectionStart.rowIndex;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lines<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 获取到被复制的某一行</span>
        <span class="token comment">// let line = copydata[i % needFillLinesCount];</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">+</span> i <span class="token operator">&gt;</span> tableData<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> row <span class="token operator">=</span> tableData<span class="token punctuation">[</span>selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> needFillLines<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>needFillStartSelectionCellIndex <span class="token operator">+</span> j <span class="token operator">&gt;</span> tableColumn<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> column <span class="token operator">=</span> tableColumn<span class="token punctuation">[</span>needFillStartSelectionCellIndex <span class="token operator">-</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>column<span class="token punctuation">.</span>editRender<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            row<span class="token punctuation">[</span>column<span class="token punctuation">.</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> copydata<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>selectionExtendOldStart<span class="token punctuation">.</span>cellIndex <span class="token operator">-</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> cells<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// emit(&#39;afterPasteMethod&#39;, getTablexGrid().getUpdateRecords());</span>
  <span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">afterPasteMethodFunC</span><span class="token punctuation">(</span><span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getUpdateRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//鼠标按键结束事件,添加在了window中</span>
<span class="token keyword">const</span> <span class="token function-variable function">tbodymouseup</span> <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>button <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//左键松开</span>
    isSelecting<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">//标记为停止选择操作</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isExtendSelecting<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>isUp<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        selectionStart <span class="token operator">=</span> selectionExtendOldEnd<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        selectionStart <span class="token operator">=</span> selectionExtendOldStart<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>isLeft<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        selectionStart <span class="token operator">=</span> selectionExtendOldEnd<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        selectionStart <span class="token operator">=</span> selectionExtendOldStart<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionExtendEnd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        selectionEnd<span class="token punctuation">.</span>rowIndex <span class="token operator">=</span> selectionExtendEnd<span class="token punctuation">.</span>rowIndex<span class="token punctuation">;</span>
        selectionEnd<span class="token punctuation">.</span>cellIndex <span class="token operator">=</span> selectionExtendEnd<span class="token punctuation">.</span>cellIndex<span class="token punctuation">;</span>
        <span class="token function">fillDatas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setselectedCellArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">destroyExtendAreaBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      isExtendSelecting<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      isUp<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      isLeft<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> outevent <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//移动事件,不保存,循环定时器内无法监听到新的事件</span>

<span class="token comment">//鼠标移出表格事件,只在移动的时候会触发,暂停移动不触发</span>
<span class="token keyword">const</span> <span class="token function-variable function">tbodymouseout</span> <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  outevent<span class="token punctuation">.</span>value <span class="token operator">=</span> event<span class="token punctuation">;</span> <span class="token comment">//保存移动事件</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>isSelecting<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//如果正在执行选中操作</span>
    <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">//开启循环定时器</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>isSelecting<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//判断当前是否正在选择</span>
        <span class="token comment">//获取表格元素</span>
        <span class="token keyword">var</span> table <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--body-wrapper table&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取非固定列(和固定列)的table元素</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>outevent<span class="token punctuation">.</span>value<span class="token punctuation">.</span>clientX <span class="token operator">&gt;</span> table<span class="token punctuation">.</span>parentElement<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>right <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">//判断鼠标x轴是否超出表格右侧,向右滚动</span>
          <span class="token keyword">var</span> maxScrollPosition <span class="token operator">=</span> table<span class="token punctuation">.</span>parentElement<span class="token punctuation">.</span>scrollWidth <span class="token operator">-</span> table<span class="token punctuation">.</span>parentElement<span class="token punctuation">.</span>clientWidth<span class="token punctuation">;</span> <span class="token comment">//获取滚动条最大位置</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>table<span class="token punctuation">.</span>parentElement<span class="token punctuation">.</span>scrollLeft <span class="token operator">&lt;</span> maxScrollPosition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//如果没到滚动条最大位置,执行滚动</span>
            table<span class="token punctuation">.</span>parentElement<span class="token punctuation">.</span>scrollLeft <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//执行水平滚动条向右滚动</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>outevent<span class="token punctuation">.</span>value<span class="token punctuation">.</span>clientX <span class="token operator">&lt;</span> table<span class="token punctuation">.</span>parentElement<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>left <span class="token operator">+</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">//判断鼠标x轴是否超出表格左侧,向左滚动</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>table<span class="token punctuation">.</span>parentElement<span class="token punctuation">.</span>scrollLeft <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//如果没到滚动条最大位置,执行滚动</span>
            <span class="token comment">//鼠标移出表格，滚动水平滚动条</span>
            table<span class="token punctuation">.</span>parentElement<span class="token punctuation">.</span>scrollLeft <span class="token operator">-=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//执行水平滚动条向右滚动</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//清除循环定时器</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//这里设置滑动速度</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//节流函数,todo//改为全局</span>
<span class="token keyword">const</span> <span class="token function-variable function">throttle</span> <span class="token operator">=</span> <span class="token punctuation">(</span>fn<span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">,</span> delay<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> canRun <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>canRun<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    canRun<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      canRun<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 获取单元格位置(rowIndex, cellIndex)</span>
<span class="token keyword">const</span> <span class="token function-variable function">getCellPosition</span> <span class="token operator">=</span> <span class="token punctuation">(</span>cell<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span>tagName <span class="token operator">!==</span> <span class="token string">&#39;TD&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//将cell指向TD元素</span>
    cell <span class="token operator">=</span> cell<span class="token punctuation">.</span>parentElement<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> visibleColumn <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTableColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>visibleColumn<span class="token punctuation">;</span> <span class="token comment">//获取处理条件之后的全量表头列</span>
  <span class="token keyword">const</span> cellIndex <span class="token operator">=</span> visibleColumn<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>col<span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//返回colid相等的visibleColumn全量表头列的索引</span>
    <span class="token keyword">return</span> col<span class="token punctuation">.</span>id <span class="token operator">==</span> cell<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;colid&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> visibleData <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTableData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>visibleData<span class="token punctuation">;</span> <span class="token comment">//获取处理条件之后的全量表体数据</span>

  <span class="token keyword">const</span> rowIndex <span class="token operator">=</span> visibleData<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>row<span class="token operator">:</span> <span class="token punctuation">{</span> Guid<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//返回rowid相等的visibleData全量表体数据</span>
    <span class="token keyword">return</span> row<span class="token punctuation">.</span>Guid <span class="token operator">==</span> cell<span class="token punctuation">.</span>parentElement<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;rowid&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回rowid相等的visibleData全量表体数据的索引</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> rowIndex<span class="token punctuation">,</span> cellIndex <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 获取单元格位置(rowIndex, cellIndex)</span>
<span class="token keyword">const</span> <span class="token function-variable function">getCellExtendPosition</span> <span class="token operator">=</span> <span class="token punctuation">(</span>cell<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span>tagName <span class="token operator">!==</span> <span class="token string">&#39;TD&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//将cell指向TD元素</span>
    cell <span class="token operator">=</span> cell<span class="token punctuation">.</span>parentElement<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> visibleColumn <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTableColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>visibleColumn<span class="token punctuation">;</span> <span class="token comment">//获取处理条件之后的全量表头列</span>
  <span class="token keyword">const</span> cellIndex <span class="token operator">=</span> visibleColumn<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>col<span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//返回colid相等的visibleColumn全量表头列的索引</span>
    <span class="token keyword">return</span> col<span class="token punctuation">.</span>id <span class="token operator">==</span> cell<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;colid&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> visibleData <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTableData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>visibleData<span class="token punctuation">;</span> <span class="token comment">//获取处理条件之后的全量表体数据</span>

  <span class="token keyword">const</span> rowIndex <span class="token operator">=</span> visibleData<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>row<span class="token operator">:</span> <span class="token punctuation">{</span> Guid<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//返回rowid相等的visibleData全量表体数据</span>
    <span class="token keyword">return</span> row<span class="token punctuation">.</span>Guid <span class="token operator">==</span> cell<span class="token punctuation">.</span>parentElement<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;rowid&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回rowid相等的visibleData全量表体数据的索引</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cellIndex <span class="token operator">===</span> selectionExtendOldEnd<span class="token punctuation">.</span>cellIndex <span class="token operator">||</span> rowIndex <span class="token operator">===</span> selectionExtendOldEnd<span class="token punctuation">.</span>rowIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> rowIndex<span class="token punctuation">,</span> cellIndex <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//设置框打开</span>
<span class="token keyword">const</span> <span class="token function-variable function">setselectedCellArea</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> activeElement <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--main-wrapper .vxe-table--body-wrapper .vxe-table--cell-active-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//正常区域选中边框激活的元素(仅是边框)</span>
  <span class="token keyword">var</span> mainElement <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--main-wrapper .vxe-table--body-wrapper .vxe-table--cell-main-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//正常区域选中边框内整个范围的元素</span>
  <span class="token keyword">var</span> mainElementBtn <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--main-wrapper .vxe-table--body-wrapper .vxe-table--cell-main-area-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//正常区域选中边框内右下角的点</span>

  <span class="token keyword">var</span> leftFixedActiveElement <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-left-wrapper .vxe-table--body-wrapper .vxe-table--cell-active-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//左侧固定列选中边框激活的元素(仅是边框)</span>
  <span class="token keyword">var</span> leftFixedMainElement <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-left-wrapper .vxe-table--body-wrapper .vxe-table--cell-main-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//左侧固定列选中边框内整个范围的元素</span>
  <span class="token keyword">var</span> leftFixedMainElementBtn <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-left-wrapper .vxe-table--body-wrapper .vxe-table--cell-main-area-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//左侧固定列选中边框内整个范围的元素</span>

  <span class="token keyword">var</span> rightFixedActiveElement <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-right-wrapper .vxe-table--body-wrapper .vxe-table--cell-active-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//右侧固定列选中边框激活的元素(仅是边框)</span>
  <span class="token keyword">var</span> rightFixedMainElement <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-right-wrapper .vxe-table--body-wrapper .vxe-table--cell-main-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//右侧固定列选中边框内整个范围的元素</span>
  <span class="token keyword">var</span> rightFixedMainElementBtn <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-right-wrapper .vxe-table--body-wrapper .vxe-table--cell-main-area-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//右侧固定列选中边框内整个范围的元素</span>

  <span class="token keyword">var</span> elements <span class="token operator">=</span> <span class="token punctuation">[</span>activeElement<span class="token punctuation">,</span> mainElement<span class="token punctuation">,</span> leftFixedActiveElement<span class="token punctuation">,</span> leftFixedMainElement<span class="token punctuation">,</span> rightFixedActiveElement<span class="token punctuation">,</span> rightFixedMainElement<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> elementsContens <span class="token operator">=</span> <span class="token punctuation">[</span>mainElementBtn<span class="token punctuation">,</span> leftFixedMainElementBtn<span class="token punctuation">,</span> rightFixedMainElementBtn<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> area <span class="token operator">=</span> <span class="token function">getAreaBoxPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>area<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token punctuation">{</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> left<span class="token punctuation">,</span> top<span class="token punctuation">,</span> right <span class="token punctuation">}</span> <span class="token operator">=</span> area<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  elements<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//设置显示范围框的内部元素的样式</span>
      element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>width<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
      element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>height<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
      element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>top<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
      element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;block&#39;</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;=</span> elements<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//如果不是rightFixedActiveElement或rightFixedMainElement</span>
        element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>left<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>right<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  elementsContens<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>element <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;block&#39;</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>isEditView<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousedown&#39;</span><span class="token punctuation">,</span> extendmousedown<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的leftfixedtbody添加鼠标按下事件</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// element.addEventListener(&#39;mousemove&#39;, extendmousemove); //给表格中的leftfixedtbody添加鼠标移动事件</span>
      <span class="token comment">// element.addEventListener(&#39;mouseout&#39;, throttle(extendmouseout, 50)); //给表格中的leftfixedtbody添加鼠标移出事件</span>
      <span class="token comment">// element.addEventListener(&#39;click&#39;, extendClick); //添加单击事件</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//显示范围框</span>
  <span class="token function">openAreaBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 设置extend框打开</span>
<span class="token keyword">const</span> <span class="token function-variable function">setselectedExtendCellArea</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> extendElement <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--main-wrapper .vxe-table--body-wrapper .vxe-table--cell-extend-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> leftFixedExtendElement <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-left-wrapper .vxe-table--body-wrapper .vxe-table--cell-extend-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//左侧固定列选中边框激活的元素(仅是边框)</span>

  <span class="token keyword">var</span> rightFixedExtendElement <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-right-wrapper .vxe-table--body-wrapper .vxe-table--cell-extend-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//右侧固定列选中边框激活的元素(仅是边框)</span>

  <span class="token keyword">var</span> elements <span class="token operator">=</span> <span class="token punctuation">[</span>extendElement<span class="token punctuation">,</span> leftFixedExtendElement<span class="token punctuation">,</span> rightFixedExtendElement<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> area <span class="token operator">=</span> <span class="token function">getAreaBoxExtendPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>area<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token punctuation">{</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> left<span class="token punctuation">,</span> top<span class="token punctuation">,</span> right <span class="token punctuation">}</span> <span class="token operator">=</span> area<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  elements<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//设置显示范围框的内部元素的样式</span>
      element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>width<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
      element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>height<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
      element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>top<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
      element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;block&#39;</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;=</span> elements<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//如果不是rightFixedActiveElement或rightFixedMainElement</span>
        element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>left<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>right<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 取消extend监听</span>
<span class="token keyword">const</span> <span class="token function-variable function">removeExtendListener</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> mainElementBtn <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--main-wrapper .vxe-table--body-wrapper .vxe-table--cell-main-area-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//正常区域选中边框内右下角的点</span>
    <span class="token keyword">var</span> leftFixedMainElementBtn <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-left-wrapper .vxe-table--body-wrapper .vxe-table--cell-main-area-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//左侧固定列选中边框内整个范围的元素</span>
    <span class="token keyword">var</span> rightFixedMainElementBtn <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-right-wrapper .vxe-table--body-wrapper .vxe-table--cell-main-area-btn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//右侧固定列选中边框内整个范围的元素</span>
    <span class="token keyword">var</span> elementsContens <span class="token operator">=</span> <span class="token punctuation">[</span>mainElementBtn<span class="token punctuation">,</span> leftFixedMainElementBtn<span class="token punctuation">,</span> rightFixedMainElementBtn<span class="token punctuation">]</span><span class="token punctuation">;</span>
    elementsContens<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>element <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousedown&#39;</span><span class="token punctuation">,</span> extendmousedown<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给表格中的leftfixedtbody添加鼠标按下事件</span>
        element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">;</span>

        <span class="token comment">// element.addEventListener(&#39;mousemove&#39;, extendmousemove); //给表格中的leftfixedtbody添加鼠标移动事件</span>
        <span class="token comment">// element.addEventListener(&#39;mouseout&#39;, throttle(extendmouseout, 50)); //给表格中的leftfixedtbody添加鼠标移出事件</span>
        <span class="token comment">// element.addEventListener(&#39;click&#39;, extendClick); //添加单击事件</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//销毁范围框</span>
<span class="token keyword">const</span> <span class="token function-variable function">destroyExtendAreaBox</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> element <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--main-wrapper .vxe-table--body-wrapper .vxe-table--cell-extend-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  element <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-left-wrapper .vxe-table--body-wrapper .vxe-table--cell-extend-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  element <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-right-wrapper .vxe-table--body-wrapper .vxe-table--cell-extend-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//根据开始位置和结束位置的索引计算框的width,height,left,top(左侧固定列和正常区域和右侧固定列使用)</span>
<span class="token keyword">const</span> <span class="token function-variable function">getAreaBoxPosition</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> startRowIndex <span class="token operator">=</span> selectionStart<span class="token punctuation">.</span>rowIndex<span class="token punctuation">;</span> <span class="token comment">//获取选中起始行索引</span>
  <span class="token keyword">let</span> endRowIndex <span class="token operator">=</span> selectionEnd<span class="token punctuation">.</span>rowIndex<span class="token punctuation">;</span> <span class="token comment">//获取选中结束行索引</span>
  <span class="token keyword">let</span> startColumnIndex <span class="token operator">=</span> selectionStart<span class="token punctuation">.</span>cellIndex<span class="token punctuation">;</span> <span class="token comment">//获取选中起始列索引</span>
  <span class="token keyword">let</span> endColumnIndex <span class="token operator">=</span> selectionEnd<span class="token punctuation">.</span>cellIndex<span class="token punctuation">;</span> <span class="token comment">//获取选中结束列索引</span>
  <span class="token keyword">let</span> visibleColumn <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTableColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>visibleColumn<span class="token punctuation">;</span> <span class="token comment">//获取处理条件之后的全量表头列</span>
  <span class="token keyword">let</span> visibleData <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTableData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>visibleData<span class="token punctuation">;</span> <span class="token comment">//获取处理条件之后的全量表体数据</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>startColumnIndex <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> endColumnIndex <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> startRowIndex <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> endRowIndex <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> maxColumnIndex <span class="token operator">=</span> visibleColumn<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//最大列索引</span>
  <span class="token keyword">var</span> maxRowIndex <span class="token operator">=</span> visibleData<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//最大行索引</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>endColumnIndex <span class="token operator">&gt;</span> maxColumnIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//到最后一列,指向最后一列</span>
    endColumnIndex <span class="token operator">=</span> maxColumnIndex<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>endRowIndex <span class="token operator">&gt;</span> maxRowIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//到最后一行,指向最后一行</span>
    endRowIndex <span class="token operator">=</span> maxRowIndex<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> width <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    height <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    right <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  visibleColumn<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>col<span class="token operator">:</span> <span class="token punctuation">{</span> renderWidth<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>startColumnIndex <span class="token operator">&lt;=</span> endColumnIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//开始列索引小于结束列索引,即从左往右选择</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> startColumnIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        left <span class="token operator">+=</span> col<span class="token punctuation">.</span>renderWidth<span class="token punctuation">;</span> <span class="token comment">//距离表格整体左侧边框距离</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;</span> endColumnIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//数据索引大于结束列,这里获取距离后面数据的宽度</span>
        right <span class="token operator">+=</span> col<span class="token punctuation">.</span>renderWidth<span class="token punctuation">;</span> <span class="token comment">//距离表格整体右侧边框距离,加上当前列</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>startColumnIndex <span class="token operator">&lt;=</span> index <span class="token operator">&amp;&amp;</span> index <span class="token operator">&lt;=</span> endColumnIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//开始列索引大于数据索引 和 结束列索引小于数据索引,这里获取选中区域的宽度</span>
        width <span class="token operator">+=</span> col<span class="token punctuation">.</span>renderWidth<span class="token punctuation">;</span> <span class="token comment">//选中区域的宽度</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">//从右往左选择</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> endColumnIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        left <span class="token operator">+=</span> col<span class="token punctuation">.</span>renderWidth<span class="token punctuation">;</span> <span class="token comment">//距离表格整体左侧边框距离</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;</span> startColumnIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//数据索引大于开始列,这里获取距离后面数据的宽度</span>
        right <span class="token operator">+=</span> col<span class="token punctuation">.</span>renderWidth<span class="token punctuation">;</span> <span class="token comment">//距离表格整体右侧边框距离,加上当前列</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>startColumnIndex <span class="token operator">&gt;=</span> index <span class="token operator">&amp;&amp;</span> index <span class="token operator">&gt;=</span> endColumnIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//开始列索引大于数据索引 和 结束列索引小于数据索引,这里获取选中区域的宽度</span>
        width <span class="token operator">+=</span> col<span class="token punctuation">.</span>renderWidth<span class="token punctuation">;</span> <span class="token comment">//选中区域的宽度</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>startRowIndex <span class="token operator">&lt;=</span> endRowIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//开始行索引小于结束行索引,即从上往下选择</span>
    height <span class="token operator">=</span> <span class="token punctuation">(</span>endRowIndex <span class="token operator">-</span> startRowIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">36</span><span class="token punctuation">;</span> <span class="token comment">//选中区域的高度</span>
    top <span class="token operator">=</span> startRowIndex <span class="token operator">*</span> <span class="token number">36</span><span class="token punctuation">;</span> <span class="token comment">//距离表格整体顶部边框距离</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    height <span class="token operator">=</span> <span class="token punctuation">(</span>startRowIndex <span class="token operator">-</span> endRowIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">36</span><span class="token punctuation">;</span> <span class="token comment">//选中区域的高度</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isUp<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      height <span class="token operator">=</span> height <span class="token operator">+</span> <span class="token punctuation">(</span>selectionExtendOldEnd<span class="token punctuation">.</span>rowIndex <span class="token operator">-</span> selectionExtendOldStart<span class="token punctuation">.</span>rowIndex<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">36</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    top <span class="token operator">=</span> endRowIndex <span class="token operator">*</span> <span class="token number">36</span><span class="token punctuation">;</span> <span class="token comment">//距离表格整体顶部边框距离</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> left<span class="token punctuation">,</span> top<span class="token punctuation">,</span> right <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//销毁范围框</span>
<span class="token keyword">const</span> <span class="token function-variable function">destroyAreaBox</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> element <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--main-wrapper .vxe-table--body-wrapper .vxe-table--cell-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  element <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-left-wrapper .vxe-table--body-wrapper .vxe-table--cell-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  element <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--fixed-wrapper .vxe-table--fixed-right-wrapper .vxe-table--body-wrapper .vxe-table--cell-area&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//表格单元格点击事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">tableCellClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isSelecting<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//非选中状态</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      selectionStart <span class="token operator">=</span> <span class="token function">getCellPosition</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取单元格位置</span>
      selectionEnd <span class="token operator">=</span> selectionStart<span class="token punctuation">;</span> <span class="token comment">//结束位置也是自己</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>selectionStart<span class="token punctuation">,</span> selectionEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//设置样式</span>
      <span class="token function">setselectedCellArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//表格右键点击事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">tableCellMenuClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isSelecting<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//非选中状态</span>
    <span class="token keyword">let</span> currentCellPosition <span class="token operator">=</span> <span class="token function">getCellPosition</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取单元格位置</span>
    <span class="token keyword">var</span> horizontalFlag<span class="token punctuation">;</span> <span class="token comment">//是否在范围框的水平判断标记</span>
    <span class="token keyword">var</span> verticalFlag<span class="token punctuation">;</span> <span class="token comment">//是否在范围框的垂直判断标记</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionStart<span class="token punctuation">.</span>cellIndex <span class="token operator">&lt;=</span> selectionEnd<span class="token punctuation">.</span>cellIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//如果是从左往右选取</span>
      horizontalFlag <span class="token operator">=</span> selectionStart<span class="token punctuation">.</span>cellIndex <span class="token operator">&lt;=</span> currentCellPosition<span class="token punctuation">.</span>cellIndex <span class="token operator">&amp;&amp;</span> currentCellPosition<span class="token punctuation">.</span>cellIndex <span class="token operator">&lt;=</span> selectionEnd<span class="token punctuation">.</span>cellIndex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">//从右往左选取</span>
      horizontalFlag <span class="token operator">=</span> selectionEnd<span class="token punctuation">.</span>cellIndex <span class="token operator">&lt;=</span> currentCellPosition<span class="token punctuation">.</span>cellIndex <span class="token operator">&amp;&amp;</span> currentCellPosition<span class="token punctuation">.</span>cellIndex <span class="token operator">&lt;=</span> selectionStart<span class="token punctuation">.</span>cellIndex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">&lt;=</span> selectionEnd<span class="token punctuation">.</span>rowIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//如果是从上往下选取</span>
      verticalFlag <span class="token operator">=</span> selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">&lt;=</span> currentCellPosition<span class="token punctuation">.</span>rowIndex <span class="token operator">&amp;&amp;</span> currentCellPosition<span class="token punctuation">.</span>rowIndex <span class="token operator">&lt;=</span> selectionEnd<span class="token punctuation">.</span>rowIndex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">//从下往上选取</span>
      verticalFlag <span class="token operator">=</span> selectionEnd<span class="token punctuation">.</span>rowIndex <span class="token operator">&lt;=</span> currentCellPosition<span class="token punctuation">.</span>rowIndex <span class="token operator">&amp;&amp;</span> currentCellPosition<span class="token punctuation">.</span>rowIndex <span class="token operator">&lt;=</span> selectionStart<span class="token punctuation">.</span>rowIndex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>horizontalFlag <span class="token operator">&amp;&amp;</span> verticalFlag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//判断如果不在选中区域内,触发表格左键单击事件,更新截取单元格,否则如果在正常触发右键菜单</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      selectionStart <span class="token operator">=</span> <span class="token function">getCellPosition</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取单元格位置</span>
      selectionEnd <span class="token operator">=</span> selectionStart<span class="token punctuation">;</span> <span class="token comment">//结束位置也是自己</span>
      <span class="token comment">//设置样式</span>
      <span class="token function">setselectedCellArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 获取复制的数据</span>
<span class="token keyword">const</span> <span class="token function-variable function">getDataByArea</span> <span class="token operator">=</span> <span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> start<span class="token punctuation">.</span>rowIndex<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> end<span class="token punctuation">.</span>rowIndex<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> row <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> start<span class="token punctuation">.</span>cellIndex<span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> end<span class="token punctuation">.</span>cellIndex<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTableData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>visibleData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> head <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTableColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>visibleColumn<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
      row<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>head<span class="token punctuation">.</span>field<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// if (event === true) {</span>
      <span class="token comment">//   // 判断是否需要重写属性</span>
      <span class="token comment">//</span>
      <span class="token comment">// } else {</span>
      <span class="token comment">//   row.push(data[head.field]);</span>
      <span class="token comment">// }</span>
    <span class="token punctuation">}</span>
    data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">copyEvent</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//我给大家打印处理:</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;是否正在进行滑动选中操作：&#39;</span><span class="token punctuation">,</span> isSelecting<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//左上角坐标</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;单元格起始位置：索引:&#39;</span><span class="token punctuation">,</span> selectionStart<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//右下角坐标</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;单元格结束位置：索引:&#39;</span><span class="token punctuation">,</span> selectionEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//这里需要是visibleData</span>
  <span class="token comment">// let tableData = getTablexGrid().getTableData().visibleData; //获取处理条件之后的全量表体数据</span>
  <span class="token comment">// let rowStart = selectionStart.rowIndex; //获取选中起始行索引</span>
  <span class="token comment">// let rowEnd = selectionEnd.rowIndex; //获取选中结束行索引</span>
  <span class="token comment">// let selectRows = tableData.filter((col, index: number) =&gt; {</span>
  <span class="token comment">//     //col参数不能改否则会获取不到数据</span>
  <span class="token comment">//     //这里修改从右下往左上拖动的数据显示</span>
  <span class="token comment">//     if (rowStart &lt;= rowEnd) {</span>
  <span class="token comment">//         return rowStart &lt;= index &amp;&amp; rowEnd &gt;= index;</span>
  <span class="token comment">//     } else {</span>
  <span class="token comment">//         return rowStart &gt;= index &amp;&amp; rowEnd &lt;= index;</span>
  <span class="token comment">//     }</span>
  <span class="token comment">// });</span>
  <span class="token comment">// console.log(&#39;鼠标选中行:&#39;, JSON.stringify(selectRows));</span>

  <span class="token comment">// //这里需要是visibleColumn</span>
  <span class="token comment">// let colStart = selectionStart.cellIndex; //获取选中起始列索引</span>
  <span class="token comment">// let colEnd = selectionEnd.cellIndex; //获取选中结束列索引</span>
  <span class="token comment">// let tableColumn = getTablexGrid().getTableColumn().visibleColumn; //获取处理条件之后的全量表头列</span>
  <span class="token comment">// let selectCols = tableColumn.filter((col, index: number) =&gt; {</span>
  <span class="token comment">//     //col参数不能改否则会获取不到数据</span>
  <span class="token comment">//     //这里修改从右下往左上拖动的数据显示</span>
  <span class="token comment">//     if (colStart &lt;= colEnd) {</span>
  <span class="token comment">//         return colStart &lt;= index &amp;&amp; colEnd &gt;= index;</span>
  <span class="token comment">//     } else {</span>
  <span class="token comment">//         return colStart &gt;= index &amp;&amp; colEnd &lt;= index;</span>
  <span class="token comment">//     }</span>
  <span class="token comment">// });</span>
  <span class="token comment">// console.log(&#39;鼠标选中列:&#39;, JSON.stringify(selectCols));.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tableCom<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">getDataByArea</span><span class="token punctuation">(</span>selectionStart<span class="token punctuation">,</span> selectionEnd<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;\\t&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;\\n&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// event.clipboardData.setData(&#39;text/plain&#39;, result);</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>XEClipboard<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      VXETable<span class="token punctuation">.</span>modal<span class="token punctuation">.</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        status<span class="token operator">:</span> <span class="token string">&#39;success&#39;</span><span class="token punctuation">,</span>
        content<span class="token operator">:</span> <span class="token string">&#39;复制成功&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el <span class="token operator">&amp;&amp;</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--render-wrapper&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      selectionStart<span class="token punctuation">.</span>cellIndex <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      selectionEnd<span class="token punctuation">.</span>cellIndex <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      selectionEnd<span class="token punctuation">.</span>rowIndex <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token function">destroyAreaBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// await toClipboard(result);</span>
  <span class="token comment">// VXETable.modal.message({</span>
  <span class="token comment">//     status: &#39;success&#39;,</span>
  <span class="token comment">//     content: &#39;复制成功&#39;</span>
  <span class="token comment">// });</span>

  <span class="token comment">// 复制成功取消区域选择框</span>
  <span class="token comment">// destroyAreaBox();</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">pasteEvent</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>text <span class="token operator">&amp;&amp;</span> tableCom<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> tableData <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTableData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>visibleData<span class="token punctuation">;</span>
    <span class="token keyword">let</span> tableColumn <span class="token operator">=</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTableColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>visibleColumn<span class="token punctuation">;</span> <span class="token comment">//获取处理条件之后的全量表头列</span>
    <span class="token comment">//去除首尾换行</span>
    text <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\\r\\n+|\\r\\n+$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> snsArr <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\r\\n+</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> tArr <span class="token operator">=</span> snsArr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>value <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&#39;\\t&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tArr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> line <span class="token operator">=</span> tArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">+</span> i <span class="token operator">&gt;</span> tableData<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> row <span class="token operator">=</span> tableData<span class="token punctuation">[</span>selectionStart<span class="token punctuation">.</span>rowIndex <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> line<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>selectionStart<span class="token punctuation">.</span>cellIndex <span class="token operator">+</span> j <span class="token operator">&gt;</span> tableColumn<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> column <span class="token operator">=</span> tableColumn<span class="token punctuation">[</span>selectionStart<span class="token punctuation">.</span>cellIndex <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>column<span class="token punctuation">.</span>editRender<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          row<span class="token punctuation">[</span>column<span class="token punctuation">.</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> line<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 粘贴事件完成以后 你自己的逻辑</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 在某个时刻不要忘记取消监听</span>
<span class="token function">onBeforeUnmount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">removeListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el <span class="token operator">&amp;&amp;</span> <span class="token function">getTablexGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.vxe-table--render-wrapper&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">removeExtendListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11),o=[e];function c(l,i){return s(),a("div",null,o)}const k=n(p,[["render",c],["__file","vxeTablefukequyuxuanze、tuodongbing.html.vue"]]);export{k as default};
